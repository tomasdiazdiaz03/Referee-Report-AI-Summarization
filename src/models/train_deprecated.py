from transformers import T5Tokenizer, T5ForConditionalGeneration

# Cargar el modelo preentrenado
tokenizer = T5Tokenizer.from_pretrained("t5-small")
model = T5ForConditionalGeneration.from_pretrained("t5-small")

# Entrada: Informe arbitral sin el resumen final
input_text = '"condicion_fisica": "Enfoque táctico adecuado y eficiente. Buena condición física con rápidas aceleraciones (minutos 12:31, 49:33 y 77:39), a pesar de la temperatura fría y húmeda.", "actuacion_tecnica": "", "incidencias_penaltis": {"sanciones": {"PENALTIS SEÑALADOS:": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}, "ACCIONES DE ÁREA SIGNIFICATIVAS NO SANCIONADAS COMO PENALTI:": {"Acierto": "3", "Error": "1", "Beneficio/Duda": ""}}, "incidentes_area_penalti": [{"Minuto": "07:11", "Decision": "No penalti", "Opinion_evaluador": "Acierto"}, {"Minuto": "25:08", "Decision": "No penalti", "Opinion_evaluador": "Acierto"}, {"Minuto": "29:38", "Decision": "No penalti", "Opinion_evaluador": "Acierto"}, {"Minuto": "49:42", "Decision": "No penalti", "Opinion_evaluador": "Error"}]}, "actuacion_disciplinaria": "", "incidencias_disciplinarias": {"tarjetas": {"TARJETAS AMARILLAS MOSTRADAS:": {"Acierto": "7", "Error": "", "Beneficio/Duda": ""}, "TARJETAS AMARILLAS NO MOSTRADAS:": {"Acierto": "2", "Error": "", "Beneficio/Duda": ""}, "2ª TARJETAS AMARILLAS MOSTRADAS:": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}, "TARJETAS ROJAS DIRECTAS NO MOSTRADAS:": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}}, "incidentes_disciplinarios": [{"Minuto": "00:42", "Decision_arbitro": "Sin tarjeta", "Opinion_evaluador": "Sin tarjeta"}, {"Minuto": "15:52", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "29:11", "Decision_arbitro": "Sin tarjeta", "Opinion_evaluador": "Sin tarjeta"}, {"Minuto": "31:03", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "55:02", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "87:44", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "90+1:38", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "90+2:36", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}, {"Minuto": "90+4:05", "Decision_arbitro": "Tarjeta amarilla", "Opinion_evaluador": "Tarjeta amarilla"}]}, "manejo_partido": "Minuto Breve descripción de la acción 15:52 Buena elección de primera amarilla del partido por zancadilla temeraria de 8-pon por encima del tobillo a un adversario, en disputa de balón. 24:04 23-pon pone la mano en la cara a un adversario en disputa de balón. Detecta y corta posibilidad de subir temperatura. 27:02 Para el juego por lesión 30-pon y sustitución correspondiente. 49:42 Gestiona con calma y actitud positiva la revisión larga de una mano en el área-pon, sabiendo realizar el procedimiento y detectando un fuera de juego por interferencia, obteniendo la mejor decisión final. Explica con buen talante a los jugadores y mantiene el control de la situación. 87:44 Aumenta la atención y el rigor para sujetar el partido hasta el final, tras una revisión decisiva. Mantiene el control disciplinario y no perdona amonestaciones claras. COMENTARIOS ADICIONALES AL MANEJO DE PARTIDO (Si fuera necesario):", "personalidad": "", "trabajo_equipo": "", "asistente_1": {"acciones": {"DECISIONES DE FUERA DE JUEGO SEÑALADOS:": {"Acierto": "2", "Error": "", "Beneficio/Duda": ""}, "DECISIONES RELEVANTES DE FUERA DE JUEGO NO SEÑALADOS:": {"Acierto": "7", "Error": "", "Beneficio/Duda": ""}, "AYUDA AL ÁRBITRO EN ACCIONES DISCIPLINARIAS:": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}, "RETRASAR LA BANDERA EN ACCIONES PRÓXIMAS A GOL (SOLO CON VAR):": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}}, "jugadas_fuera_de_juego": [{"Minuto": "01:33", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "10:17", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "11:48", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "23:26", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "43:23", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "68:52", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "73:38", "Decision": "Fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "76:44", "Decision": "Fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "78:28", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}]}, "asistente_1_comentarios": "", "asistente_2": {"acciones": {"DECISIONES DE FUERA DE JUEGO SEÑALADOS:": {"Acierto": "1", "Error": "", "Beneficio/Duda": ""}, "DECISIONES RELEVANTES DE FUERA DE JUEGO NO SEÑALADOS:": {"Acierto": "3", "Error": "1", "Beneficio/Duda": ""}, "AYUDA AL ÁRBITRO EN ACCIONES DISCIPLINARIAS:": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}, "RETRASAR LA BANDERA EN ACCIONES PRÓXIMAS A GOL (SOLO CON VAR):": {"Acierto": "", "Error": "", "Beneficio/Duda": ""}}, "jugadas_fuera_de_juego": [{"Minuto": "01:33", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "10:17", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "11:48", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "23:26", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "43:23", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "68:52", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "73:38", "Decision": "Fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "76:44", "Decision": "Fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "78:28", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "14:37", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "39:28", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "49:42", "Decision": "No fuera de juego", "Opinion_evaluador": "Error"}, {"Minuto": "72:43", "Decision": "Fuera de juego", "Opinion_evaluador": "Acierto"}, {"Minuto": "87:10", "Decision": "No fuera de juego", "Opinion_evaluador": "Acierto"}]}, "asistente_2_comentarios": "", "cuarto_arbitro": "Realizó con eficiencia sus funciones y colaboró adecuadamente con el equipo arbitral.", "resumen_final": "Árbitro ASPECTOS MÁS DESTACADOS: - Buen manejo y control de los jugadores con advertencias, pro-actividad y sabiendo elegir la primera amarilla. Gestiona con calma y actitud positiva la revisión larga de una mano en el área-pon, sabiendo realizar el procedimiento y detectando un fuera de juego por interferencia, obteniendo la mejor decisión final. Explica con buen talante a los jugadores, mantiene el control de la situación con la suficiente autoridad y consigue la credibilidad necesaria. - Aumenta la atención y el rigor para sujetar el partido hasta el final, tras una revisión decisiva. Mantiene el control disciplinario y no perdona amonestaciones claras. Es hábil e inteligente para amonestar a 19-pon por protestar, entre una serie de jugadores visitantes. - Criterio técnico homogéneo y equilibrado. Señaló las infracciones claras. Dejó seguir el juego correctamente tras un despeje de cabeza y con las dos manos en alto del portero-pon, fuera del área, evitando una ocasión clara de gol. - Permitió continuar el juego correctamente en tres acciones de área. - Criterio disciplinario coherente, acertado y constante. Mostró correctamente 7 amarillas. Gestionó varias acciones sin la necesidad de amonestar. - Enfoque táctico adecuado y eficiente. Buenas aceleraciones rápidas. RECOMENDACIONES DE MEJORA: - Detectar una mano punible difícil (minuto 49:42), en el interior del área visitante. - Mejorable la comunicación con el equipo de vídeo y el asistente número 1, tras una acción compleja (minuto 49:42), y revisión posterior. - Debió añadir, al menos, 6 minutos de tiempo adicional en la segunda mitad (concedió 5 minutos). Hubo 3 ventanas de sustituciones y 6 minutos desde que se produce la acción de la mano (49:42), hasta que se reanuda el juego. Árbitro asistente 1 ASPECTOS MÁS DESTACADOS: - Dejó seguir el juego oportunamente en cuatro acciones bastante ajustadas, dos de ellas finalizaron en gol, y otras tres ajustadas. - Determinó correctamente dos fueras de juego. - Buen posicionamiento con el penúltimo defensor. - Buena reacción y aceleración en carrera. RECOMENDACIONES DE MEJORA: - El árbitro pita para que se saque un tiro libre sin mirar y 7-ibi está encima del balón. Le debe avisar algún miembro del equipo arbitral para evitar pitar (minuto 90+4:50). Árbitro asistente 2 ASPECTOS MÁS DESTACADOS: - Dejó seguir el juego oportunamente en una ocasión bastante ajustada y dos ajustadas. - Señaló acertadamente un fuera de juego. RECOMENDACIONES DE MEJORA: - Alertar y detectar un fuera de juego por interferencia milimétrico, en el momento en el que se produce, debiendo indicar al principal y al equipo de vídeo (minuto 49:42). - Debió ayudar para señalar una falta cerca de su zona (minuto 77:39)."}'

# Tokenizar y generar el resumen
inputs = tokenizer("summarize: " + input_text, return_tensors="pt", max_length=1024, truncation=True)
summary_ids = model.generate(inputs["input_ids"], max_length=250, num_beams=4, early_stopping=True)

# Decodificar la salida
generated_summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)
print(generated_summary)